---
tags:
  - aws/security
  - aws/network
up:
  - "[[AWS Network & Content Delivery]]"
related:
  - "[[Infrastructure Security]]"
---
## Overview

API stands for Application Programming Interface. It's a way that you can take an application you developed and provide its functionality either directly to users, system utilities, or other applications to include that functionality inside their code. It's a way applications or services can communicate with each other.

- API Gateway is an AWS managed service:
    - Provides managed AWS endpoints.
    - Can also perform authentication to prove you are who you claim.
    - You can create an API and present it to your customers for use.
- Enables you to build RESTful APIs and WebSocket APIs that are optimized for serverless workloads.
- Allows you to create, publish, monitor, and secure APIs (and it does these tasks as a service).
- Billed based on:
    - number of API calls
    - amount of data transferred
    - additional performance features such as caching
- Serve as an entry point for serverless architecture.
- They come in handy during architecture evolution. For instance, if you have on premises legacy services that use APIs, this can be integrated.

Great during an architecture evolution because the endpoints don't change.

1. Create a managed API and point at the existing monolithic application.
2. Using API gateway allows the business to evolve along the way slowly. This might move some of the data to Fargate and Aurora architecture.
3. Move to a full serverless architecture with DynamoDB.

## Important Concepts

**Amazon API Gateway** provides throttling at multiple levels including global and by a service call. Throttling limits can be set for standard rates and bursts. For example, API owners can set a rate limit of 1,000 requests per second for a specific method in their REST APIs, and also configure Amazon API Gateway to handle a burst of 2,000 requests per second for a few seconds.

Amazon API Gateway tracks the number of requests per second. Any requests over the limit will receive a 429 HTTP response. The client SDKs generated by Amazon API Gateway retry calls automatically when met with this response.

## Integrations High Level

### Lambda Function

- Invoke [[AWS Lambda|Lambda]] function
- Easy way to expose REST API backed by Lambda

### HTTP

- Expose HTTP endpoints in the backend
	- For example: internal HTTP API on premise, [[Application Load Balancer]]
	- Why? Add rate limiting, caching, user authentications, API keys, etc.

### AWS Service

- Expose any AWS API through the API Gateway
- Example: start an [[AWS Step Functions]] workflow, post a message to [[Amazon SQS|SQS]]
- why? Add authentication, deploy publicly, rate control

## Endpoint Types

### Edge-Optimized (default)

- For global clients
- Requests are routed through [[Edge Locations]]
- The API Gateway still lives in only one region

### Regional

- For clients within the same region
- Could manually combine with [[Amazon CloudFront|CloudFront]] (more control over the caching strategies and the distribution)

## Private

- Can only be accessed from your [[Amazon VPC|VPC]] using an interface VPC endpoint (ENI)
- Use a resource policy to define access

## Security

- User authentication through
	- [[IAM Role|IAM roles]] (useful for internal applications)
	- [[Amazon Cognito|Cognito]] (identity for external users - i.e. mobile users)
	- Custom Authorizer (your own logic)
- Custom Domain Name HTTPS security through integration with [[AWS Certificate Manager]]
	- If using Edge-Optimized endpoint, then the certificate must be in `us-east-1`
	- If using Regional endpoint, the certificate must be in the API Gateway region
	- Must setup CNAME or A-alias record in [[Route 53]]

## Throttling

- Account Limit
	- API Gateway throttles requests at 10,000 RPS across all APIs
	- Soft limit that can be increased upon request
- In case of throttling => 429 Too Many Requests (retriable error)
- Can set stage limit & method limits to improve performance
- Or you can define usage plans to throttle per customer

>[!note] Note
> One API Gateway that is overloaded and not limited can cause the other APIs to be throttled

